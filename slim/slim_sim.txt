// Script for the SLiM simulations
// Takes mutation rate (mu), mutation effect size (s), and
// recombination rate (gamma) as command line arguments


initialize() {
        initializeTreeSeq();
	if (s == 0) {
	        initializeMutationRate(0);
	}
	else {
	        initializeMutationRate(mu);
	}
        initializeMutationType('m1', 1.0, 'f', s);
        initializeGenomicElementType('g1', m1, 1.0);
        initializeGenomicElement(g1, 0, L-1);
        initializeRecombinationRate(gamma);
}

1 {
        sim.addSubpop('p1', 1e4);
}

late() {
        if (sim.generation % 1000 == 0) {
                print(sim.generation); 
        }
}

2e5 late() {
	sim.treeSeqSimplify();
	sim.treeSeqOutput(fname);
        sim.simulationFinished();
}
